<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sumida - 筋トレ記録</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #222;
            background: radial-gradient(circle at top left, #f093fb, #4facfe);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }

        .app {
            background: #ffffff;
            border-radius: 24px;
            box-shadow: 0 24px 80px rgba(0, 0, 0, 0.25);
            max-width: 960px;
            width: 100%;
            padding: 32px 28px 28px;
            animation: fadeIn 0.7s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(12px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .logo {
            font-size: 1.4rem;
            font-weight: 800;
            letter-spacing: 0.08em;
            color: #f5576c;
            text-transform: uppercase;
        }

        .tagline {
            font-size: 0.9rem;
            color: #666;
        }

        .divider {
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, #f5576c33, #4facfe33);
            margin-bottom: 24px;
        }

        .screen-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #222;
            margin-bottom: 8px;
        }

        .screen-subtitle {
            font-size: 1rem;
            color: #666;
            margin-bottom: 24px;
        }

        .form-section {
            display: grid;
            gap: 16px;
            margin-bottom: 24px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .form-group label {
            font-size: 0.9rem;
            font-weight: 600;
            color: #444;
        }

        .form-group input,
        .form-group select {
            padding: 12px 14px;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            background: #fafafa;
            transition: all 0.2s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #f5576c;
            box-shadow: 0 0 0 3px rgba(245, 87, 108, 0.1);
        }

        .part-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }

        .part-chip {
            padding: 8px 16px;
            border-radius: 999px;
            border: 1px solid #e0e0e0;
            background: #fafafa;
            font-size: 0.9rem;
            color: #555;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .part-chip:hover {
            border-color: #f5576c;
        }

        .part-chip.active {
            background: linear-gradient(90deg, #f5576c, #4facfe);
            color: #fff;
            border-color: transparent;
        }

        button {
            border: none;
            border-radius: 999px;
            padding: 12px 24px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: linear-gradient(90deg, #f5576c, #4facfe);
            color: #fff;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 28px rgba(0, 0, 0, 0.32);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #555;
        }

        .btn-secondary:hover {
            background: #ebebeb;
        }

        .btn-danger {
            background: #ff4757;
            color: #fff;
            padding: 6px 12px;
            font-size: 0.8rem;
        }

        .btn-danger:hover {
            background: #ff3344;
        }

        .buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .history-section {
            margin-top: 32px;
        }

        .history-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #222;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .record-count {
            background: linear-gradient(90deg, #f5576c, #4facfe);
            color: #fff;
            padding: 2px 10px;
            border-radius: 999px;
            font-size: 0.8rem;
        }

        .history-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .history-card {
            border-radius: 16px;
            border: 1px solid #e0e0e0;
            padding: 16px;
            background: #fcfcfc;
            transition: all 0.2s ease;
        }

        .history-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .history-date {
            font-size: 0.85rem;
            color: #777;
        }

        .history-part {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
            background: linear-gradient(135deg, #f093fb22, #4facfe22);
            color: #666;
        }

        .history-exercise {
            font-size: 1.1rem;
            font-weight: 700;
            color: #222;
            margin-bottom: 4px;
        }

        .history-details {
            font-size: 0.9rem;
            color: #555;
        }

        .history-details span {
            margin-right: 12px;
        }

        .history-memo {
            margin-top: 8px;
            padding: 8px 12px;
            background: #f8f8f8;
            border-radius: 8px;
            font-size: 0.85rem;
            color: #666;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #888;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 12px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f093fb11, #4facfe11);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #f5576c;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
        }

        .filter-section {
            margin-bottom: 16px;
        }

        .filter-label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .app {
                padding: 24px 18px 20px;
                border-radius: 18px;
            }

            .app-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .screen-title {
                font-size: 1.5rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <main class="app">
        <header class="app-header">
            <div>
                <div class="logo">sumida</div>
                <div class="tagline">毎日の筋トレを記録して成長を実感</div>
            </div>
            <a href="index.html" style="color: #f5576c; text-decoration: none; font-size: 0.9rem;">診断ページへ</a>
        </header>

        <div class="divider"></div>

        <h1 class="screen-title">筋トレ記録</h1>
        <p class="screen-subtitle">トレーニング内容を記録して、継続と成長を可視化しましょう。</p>

        <!-- 統計 -->
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
                <div class="stat-value" id="totalRecords">0</div>
                <div class="stat-label">総記録数</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="thisWeek">0</div>
                <div class="stat-label">今週の記録</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="thisMonth">0</div>
                <div class="stat-label">今月の記録</div>
            </div>
        </div>

        <!-- 入力フォーム -->
        <form id="workoutForm">
            <div class="form-section">
                <div class="form-group">
                    <label>部位を選択</label>
                    <div class="part-chips" id="partChips">
                        <span class="part-chip" data-part="胸">胸</span>
                        <span class="part-chip" data-part="背中">背中</span>
                        <span class="part-chip" data-part="肩">肩</span>
                        <span class="part-chip" data-part="腕">腕</span>
                        <span class="part-chip" data-part="脚">脚</span>
                        <span class="part-chip" data-part="腹">腹</span>
                        <span class="part-chip" data-part="全身">全身</span>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="exercise">種目名</label>
                        <input type="text" id="exercise" placeholder="例：ベンチプレス" required />
                    </div>
                    <div class="form-group">
                        <label for="date">日付</label>
                        <input type="date" id="date" required />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="weight">重量 (kg)</label>
                        <input type="number" id="weight" placeholder="0" min="0" step="0.5" />
                    </div>
                    <div class="form-group">
                        <label for="reps">回数</label>
                        <input type="number" id="reps" placeholder="10" min="1" required />
                    </div>
                    <div class="form-group">
                        <label for="sets">セット数</label>
                        <input type="number" id="sets" placeholder="3" min="1" required />
                    </div>
                </div>

                <div class="form-group">
                    <label for="memo">メモ（任意）</label>
                    <input type="text" id="memo" placeholder="フォームの注意点、体調など" />
                </div>
            </div>

            <div class="buttons">
                <button type="submit" class="btn-primary">記録を保存</button>
                <button type="button" class="btn-secondary" id="clearForm">クリア</button>
            </div>
        </form>

        <!-- 履歴 -->
        <section class="history-section">
            <div class="history-title">
                記録履歴
                <span class="record-count" id="recordCount">0件</span>
            </div>

            <div class="filter-section">
                <div class="filter-label">部位でフィルター</div>
                <div class="part-chips" id="filterChips">
                    <span class="part-chip active" data-filter="all">すべて</span>
                    <span class="part-chip" data-filter="胸">胸</span>
                    <span class="part-chip" data-filter="背中">背中</span>
                    <span class="part-chip" data-filter="肩">肩</span>
                    <span class="part-chip" data-filter="腕">腕</span>
                    <span class="part-chip" data-filter="脚">脚</span>
                    <span class="part-chip" data-filter="腹">腹</span>
                    <span class="part-chip" data-filter="全身">全身</span>
                </div>
            </div>

            <div class="history-list" id="historyList">
                <div class="empty-state">
                    <div class="empty-state-icon">&#128170;</div>
                    <p>まだ記録がありません。<br />最初のトレーニングを記録しましょう！</p>
                </div>
            </div>

            <div class="buttons" style="margin-top: 16px;">
                <button type="button" class="btn-secondary" id="exportData">データをエクスポート</button>
                <button type="button" class="btn-danger" id="clearAll">全データ削除</button>
            </div>
        </section>
    </main>

    <script>
        // ====== 状態管理 ======
        let records = [];
        let selectedPart = null;
        let currentFilter = 'all';

        // DOM要素
        const form = document.getElementById('workoutForm');
        const partChips = document.getElementById('partChips');
        const filterChips = document.getElementById('filterChips');
        const historyList = document.getElementById('historyList');
        const dateInput = document.getElementById('date');

        // 今日の日付をデフォルトに設定
        dateInput.valueAsDate = new Date();

        // ====== localStorage ======
        function loadRecords() {
            const saved = localStorage.getItem('workoutRecords');
            if (saved) {
                records = JSON.parse(saved);
            }
        }

        function saveRecords() {
            localStorage.setItem('workoutRecords', JSON.stringify(records));
        }

        // ====== 統計更新 ======
        function updateStats() {
            const now = new Date();
            const startOfWeek = new Date(now);
            startOfWeek.setDate(now.getDate() - now.getDay());
            startOfWeek.setHours(0, 0, 0, 0);

            const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);

            let weekCount = 0;
            let monthCount = 0;

            records.forEach(record => {
                const recordDate = new Date(record.date);
                if (recordDate >= startOfWeek) weekCount++;
                if (recordDate >= startOfMonth) monthCount++;
            });

            document.getElementById('totalRecords').textContent = records.length;
            document.getElementById('thisWeek').textContent = weekCount;
            document.getElementById('thisMonth').textContent = monthCount;
            document.getElementById('recordCount').textContent = `${records.length}件`;
        }

        // ====== 履歴表示 ======
        function renderHistory() {
            const filtered = currentFilter === 'all'
                ? records
                : records.filter(r => r.part === currentFilter);

            if (filtered.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">&#128170;</div>
                        <p>${currentFilter === 'all' ? 'まだ記録がありません。' : `「${currentFilter}」の記録がありません。`}<br />トレーニングを記録しましょう！</p>
                    </div>
                `;
                return;
            }

            // 日付順（新しい順）でソート
            const sorted = [...filtered].sort((a, b) => new Date(b.date) - new Date(a.date));

            historyList.innerHTML = sorted.map(record => `
                <article class="history-card" data-id="${record.id}">
                    <div class="history-header">
                        <span class="history-date">${formatDate(record.date)}</span>
                        <div>
                            <span class="history-part">${record.part}</span>
                            <button class="btn-danger" onclick="deleteRecord('${record.id}')" style="margin-left: 8px;">削除</button>
                        </div>
                    </div>
                    <div class="history-exercise">${record.exercise}</div>
                    <div class="history-details">
                        ${record.weight ? `<span>&#9878; ${record.weight}kg</span>` : ''}
                        <span>&#128257; ${record.reps}回</span>
                        <span>&#128260; ${record.sets}セット</span>
                    </div>
                    ${record.memo ? `<div class="history-memo">${record.memo}</div>` : ''}
                </article>
            `).join('');
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const options = { year: 'numeric', month: 'short', day: 'numeric', weekday: 'short' };
            return date.toLocaleDateString('ja-JP', options);
        }

        // ====== 部位選択 ======
        partChips.addEventListener('click', (e) => {
            const chip = e.target.closest('.part-chip');
            if (!chip) return;

            partChips.querySelectorAll('.part-chip').forEach(c => c.classList.remove('active'));
            chip.classList.add('active');
            selectedPart = chip.dataset.part;
        });

        // ====== フィルター ======
        filterChips.addEventListener('click', (e) => {
            const chip = e.target.closest('.part-chip');
            if (!chip) return;

            filterChips.querySelectorAll('.part-chip').forEach(c => c.classList.remove('active'));
            chip.classList.add('active');
            currentFilter = chip.dataset.filter;
            renderHistory();
        });

        // ====== フォーム送信 ======
        form.addEventListener('submit', (e) => {
            e.preventDefault();

            if (!selectedPart) {
                alert('部位を選択してください');
                return;
            }

            const record = {
                id: Date.now().toString(),
                part: selectedPart,
                exercise: document.getElementById('exercise').value,
                date: document.getElementById('date').value,
                weight: parseFloat(document.getElementById('weight').value) || null,
                reps: parseInt(document.getElementById('reps').value),
                sets: parseInt(document.getElementById('sets').value),
                memo: document.getElementById('memo').value || null,
            };

            records.push(record);
            saveRecords();
            updateStats();
            renderHistory();

            // フォームリセット（部位と日付は維持）
            document.getElementById('exercise').value = '';
            document.getElementById('weight').value = '';
            document.getElementById('reps').value = '';
            document.getElementById('sets').value = '';
            document.getElementById('memo').value = '';
        });

        // ====== クリアボタン ======
        document.getElementById('clearForm').addEventListener('click', () => {
            form.reset();
            dateInput.valueAsDate = new Date();
            partChips.querySelectorAll('.part-chip').forEach(c => c.classList.remove('active'));
            selectedPart = null;
        });

        // ====== 記録削除 ======
        function deleteRecord(id) {
            if (!confirm('この記録を削除しますか？')) return;
            records = records.filter(r => r.id !== id);
            saveRecords();
            updateStats();
            renderHistory();
        }

        // ====== 全データ削除 ======
        document.getElementById('clearAll').addEventListener('click', () => {
            if (!confirm('すべての記録を削除しますか？この操作は取り消せません。')) return;
            records = [];
            saveRecords();
            updateStats();
            renderHistory();
        });

        // ====== エクスポート ======
        document.getElementById('exportData').addEventListener('click', () => {
            if (records.length === 0) {
                alert('エクスポートする記録がありません');
                return;
            }

            const csv = [
                ['日付', '部位', '種目', '重量(kg)', '回数', 'セット数', 'メモ'].join(','),
                ...records.map(r => [
                    r.date,
                    r.part,
                    r.exercise,
                    r.weight || '',
                    r.reps,
                    r.sets,
                    r.memo || ''
                ].join(','))
            ].join('\n');

            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `workout_records_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
        });

        // ====== 初期化 ======
        loadRecords();
        updateStats();
        renderHistory();
    </script>
</body>
</html>
